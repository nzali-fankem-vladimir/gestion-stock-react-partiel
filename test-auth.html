<!DOCTYPE html>
<html>
<head>
    <title>Test avec Auth</title>
</head>
<body>
    <h1>Test avec Authentification</h1>
    <button onclick="testerAvecToken()">Tester avec Token</button>
    <div id="result"></div>

    <script>
        async function testerAvecToken() {
            // Récupérer le token du localStorage (comme dans votre app React)
            const token = localStorage.getItem('jeton');
            
            if (!token) {
                document.getElementById('result').innerHTML = 
                    '<p>❌ Pas de token trouvé dans localStorage</p>';
                return;
            }

            const fournisseur = {
                nom: "TestNom",
                prenom: "TestPrenom",
                mail: "test@test.com",
                numTel: "0123456789",
                idEntreprise: 1,
                adresse: {
                    adresse1: "123 Rue Test",
                    ville: "Paris",
                    codePostale: "75001",
                    pays: "France"
                }
            };

            try {
                const response = await fetch('http://localhost:8081/gestiondestock/v1/fournisseurs/create', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${token}`
                    },
                    body: JSON.stringify(fournisseur)
                });

                const result = await response.text();
                document.getElementById('result').innerHTML = 
                    `<p>Status: ${response.status}</p><p>Response: ${result}</p><p>Token utilisé: ${token.substring(0, 20)}...</p>`;
            } catch (error) {
                document.getElementById('result').innerHTML = 
                    `<p>Erreur: ${error.message}</p>`;
            }
        }
    </script>
</body>
</html>